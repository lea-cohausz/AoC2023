Initially a bit worried about the parsing but it turns out that both parts were easily solved using regular expressions.